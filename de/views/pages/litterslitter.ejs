<div id="litter" class="content" v-cloak>
  <% /* Диалоговое окно родословная (PEDIGREE)*/ %>
  <el-dialog
    title="<%= __('Pedigree') %>"
    :visible.sync="dialogPedigreeVisible"
    :fullscreen="true"
    top="1vh"
    center
    :before-close="handlerCloseDialogSlider"
    v-if="virtualPageSlug==='pedigree'"
  >
    <div class="d-flex justify-content-end">
      <!--<el-switch-->
      <!--style="display: block"-->
      <!--v-model="autoplay"-->
      <!--active-color="#13ce66"-->
      <!--inactive-color="#ff4949"-->
      <!--active-text="Autoplay"-->
      <!--inactive-text="Disable ">-->
      <!--</el-switch>-->
    </div>
    <!--<span>It should be noted that the content will not be aligned in center by default</span>-->
    <div class="block">

      <!--<span class="demonstration">Switch when indicator is clicked</span>-->
      <!-- <el-carousel
         :autoplay="autoplay"
         trigger="click"
         height="80vh"
         :initial-index="indexSlide"
         :next="handlerSetActiveSlider(indexPhoto)"
       >
         <el-carousel-item v-for="(item, key, index) in photos" :key="index">
           <h3 class="small text-center">{{ item.label }}</h3>
           <div class="my-flex-cont">
             &lt;!&ndash;<div class="my-flex-box">&ndash;&gt;
             <el-image
               :src="item.imageSrc"
               :fit="fit"></el-image>
             &lt;!&ndash;<div class="my-flex-cont">&ndash;&gt;
             &lt;!&ndash;<div class="my-flex-box">&ndash;&gt;
             &lt;!&ndash;<img :src="item.imageSrc" class="gallery" alt="">&ndash;&gt;
             &lt;!&ndash;</div>&ndash;&gt;
           </div>
           &lt;!&ndash;</div>&ndash;&gt;
         </el-carousel-item>
       </el-carousel>-->
    </div>
    <!--<span slot="footer" class="dialog-footer">-->
    <!--<el-button type="primary" @click="handlerCloseDialogSlider()" ><%= __('Close') %></el-button>-->
    <!--</span>-->
  </el-dialog>
  <% /* Диалоговое окно добавить фотосессию */ %>
  <el-dialog title="<%= __('Add photo shoot') %>"
             :visible.sync="dialogAddedPhotoSession">
    <el-form :label-position="'top'"
             :model="ruleForm" :rules="rules" ref="ruleForm"
             label-width="120px" class="demo-ruleForm">
      <% /*Название фотосессии*/ %>
      <el-form-item label="<%= __('Name photoshoot puppies') %>" prop="sessionName">
        <el-input maxlength="60" autofocus="true" show-word-limit
                  v-model="ruleForm.sessionName"></el-input>
      </el-form-item>
      <% /*Описание фотосессии*/ %>
      <el-form-item label="<%= __('Description of the photo shoot') %>"
                    prop="descriptionPhotoSession">
        <el-input maxlength="300" show-word-limit type="textarea"
                  v-model="ruleForm.descriptionPhotoSession"></el-input>
      </el-form-item>
      <el-divider content-position="left"><%= __('Puppies this litter') %></el-divider>
      <div class="photo-uploader">
        <div class="row">
          <div class="col-md-12 ">
            <% /*Загрузка фото щенков*/ %>
            <el-upload
              action="/api/v1/files/upload"
              list-type="picture-card"
              multiple
              ref="uploadPuppies"
              :on-preview="handlePictureCardPreview"
              :before-upload="beforeUpload"
              :limit="limit"
              :on-success="handleSuccessPuppies"
              :on-exceed="handleExceedPuppies"
              :on-remove="handleRemovePuppies">
              <i class="el-icon-plus"></i>
            </el-upload>
            <el-dialog :visible.sync="dialogVisible">
              <img width="100%" :src="dialogImageUrl" alt="">
            </el-dialog>



            <!------------------------------------------------------------------------------->
          </div>
        </div>
      </div>
      <!--<el-form-item label="Zones" :label-width="formLabelWidth">-->
      <!--<el-select v-model="form.region" placeholder="Please select a zone">-->
      <!--<el-option label="Zone No.1" value="shanghai"></el-option>-->
      <!--<el-option label="Zone No.2" value="beijing"></el-option>-->
      <!--</el-select>-->
      <!--</el-form-item>-->
    </el-form>
    <span slot="footer" class="dialog-footer">
    <el-button @click="dialogFormVisible = false"><%= __('Cancel') %></el-button>
    <el-button type="primary" @click="updateForm('ruleForm')"><%= __('Save') %></el-button>
  </span>
  </el-dialog>
  <% /* Диалоговое окно удалить фотосессию */ %>
  <el-dialog title="<%= __('Delete photo shoot') %>"
             :visible.sync="dialogDeletePhotoSession" center>
    <el-form :label-position="'top'"
             :model="ruleForm" :rules="rules" ref="ruleForm"
             label-width="120px" class="demo-ruleForm text-center">
      {{litter.sessionName}}
    </el-form>
    <span slot="footer" class="dialog-footer">
    <el-button @click="dialogDeletePhotoSession = false"><%= __('Cancel') %></el-button>
    <el-button type="primary" @click="deleteForm('ruleForm')"><%= __('Confirm') %></el-button>
  </span>
  </el-dialog>
  <% /* Диалоговое окно Слайдер картинок NEW*/ %>
  <el-dialog
    title="<%= __('Parents') %>"
    :visible.sync="dialogTableVisible"
    :fullscreen="true"
    top="1vh"
    :close="handlerCloseDialogSlider"
    center>
    <div class="d-flex justify-content-end">
      <el-switch
        style="display: block"
        v-model="autoplay"
        active-color="#13ce66"
        inactive-color="#ff4949"
        active-text="Autoplay"
        inactive-text="Disable ">
      </el-switch>
    </div>
    <div class="block">
      <el-carousel
        :autoplay="autoplay"
        trigger="click"
        height="80vh"
        :initial-index="indexSlide"
        :next="handlerSetActiveSlider(indexPhoto)"
      >
        <el-carousel-item v-for="(item, key, index) in photos" :key="index">
          <h3 class="small text-center">{{ item.label }}</h3>
          <div class="my-flex-cont">
            <el-image
              :src="item.imageSrc"
              :fit="fit"></el-image>
          </div>
        </el-carousel-item>
      </el-carousel>
    </div>
  </el-dialog>
  <% /* Диалоговое окно Редактор названия фотосессии*/ %>
  <el-dialog title="<%= __('Photo Shoot Editor') %>"  :visible.sync="dialogFormVisible">
    <el-form :label-position="'top'"
             :model="ruleForm" :rules="rules" ref="ruleForm"
             label-width="120px" class="demo-ruleForm">
      <% /*Название фотосессии*/ %>
      <el-form-item label="<%= __('Name photoshoot puppies') %>" prop="sessionName">
        <el-input maxlength="60" autofocus="true" show-word-limit v-model="ruleForm.sessionName"></el-input>
      </el-form-item>
    </el-form>
    <span slot="footer" class="dialog-footer">
    <el-button @click="dialogFormVisible = false"><%= __('Cancel') %></el-button>
    <el-button type="primary" @click="updatePhotoSetName('ruleForm')"><%= __('Save') %></el-button>
  </span>
  </el-dialog>
  <% /* Диалоговое окно Редактор описания фотосессии*/ %>
  <el-dialog title="<%= __('Photo Shoot Editor') %>"
             :visible.sync="dialogDescriptionPhotoSession">
    <el-form :label-position="'top'"
             :model="ruleForm" :rules="rules" ref="ruleForm"
             label-width="120px" class="demo-ruleForm">
      <% /*Описание фотосессии*/ %>
      <el-form-item label="<%= __('Description of the photo shoot') %>" prop="descriptionPhotoSession">
        <el-input maxlength="300" show-word-limit type="textarea" v-model="ruleForm.descriptionPhotoSession"></el-input>
      </el-form-item>
    </el-form>
    <span slot="footer" class="dialog-footer">
    <el-button @click="dialogDescriptionPhotoSession = false"><%= __('Cancel') %></el-button>
    <el-button type="primary" @click="updatePhotoSetDescription('ruleForm')"><%= __('Save') %></el-button>
  </span>
  </el-dialog>
  <% /* Диалоговое окно Редактор помёта*/ %>
  <el-dialog title="<%= __('Litter Editor') %>" :visible.sync="dialogEditor">
    <el-form :label-position="'top'"
             :model="ruleForm" :rules="rules" ref="ruleForm"
             label-width="120px" class="demo-ruleForm">
      <!--<el-form-item label="<%= __('Description') %>" prop="description">-->
      <!--<el-input maxlength="60" show-word-limit v-model="ruleForm.description"></el-input>-->
      <!--</el-form-item>-->
      <% /*Краткое Описание Помёта*/ %>
      <el-form-item label="<%= __('Short Litter Description') %>" prop="subtitle">
        <el-input maxlength="100" show-word-limit type="textarea" v-model="ruleForm.subtitle"></el-input>
      </el-form-item>

      <% /*Описание Помёта*/ %>
      <el-form-item label="<%= __('Description') %>" prop="description">
        <el-input maxlength="500" show-word-limit type="textarea" v-model="ruleForm.description"></el-input>
      </el-form-item>

      <!--<el-form-item label="Zones" :label-width="formLabelWidth">-->
      <!--<el-select v-model="form.region" placeholder="Please select a zone">-->
      <!--<el-option label="Zone No.1" value="shanghai"></el-option>-->
      <!--<el-option label="Zone No.2" value="beijing"></el-option>-->
      <!--</el-select>-->
      <!--</el-form-item>-->
    </el-form>
    <span slot="footer" class="dialog-footer">
    <el-button @click="dialogEditor = false"><%= __('Cancel') %></el-button>
    <el-button type="primary" @click="submitForm('ruleForm')"><%= __('Save') %></el-button>
  </span>
  </el-dialog>

  <% /* Шапка страницы */ %>
  <section class="banner-area relative">
    <div class="container">
      <div class="row d-flex align-items-center justify-content-center">
        <div class="about-content col-lg-12">
          <h1 class="text-white"><%= __('Litter Details') %></h1>
          <p><%= __('Information about new arrivals to this world.') %></p>
        </div>
      </div>
    </div>
  </section>

  <% /* Content */ %>
  <section class="portfolio_details_area section-gap">
    <div class="container">

      <div class="portfolio_details_inner ">
        <div class="row">
          <% /* Хлебные крошки */ %>
          <div class="col-md-6">
            <el-breadcrumb separator-class="el-icon-arrow-right">
              <el-breadcrumb-item><a href="/"><%= __('Home-menu') %></a></el-breadcrumb-item>
              <el-breadcrumb-item><a href="/litters"><%= __('Litters') %></a></el-breadcrumb-item>
              <el-breadcrumb-item><%= __('Litter') %> {{litter.letter}}</el-breadcrumb-item>
              <!--<el-breadcrumb-item>promotion detail</el-breadcrumb-item>-->
            </el-breadcrumb>
          </div>
          <% /* Буквы помётов (кнопки переключения помётов) */ %>
          <div class="col-md-6">
            <div class="text-right">
              <el-button-group v-for="(lett, index) in letters" :key="lett.id">

                <el-button v-if="lett.letter === litter.letter" @click="goTo(lett.link)" type="warning" size="mini">
                  {{lett.letter}}
                </el-button>
                <el-button v-else @click="goTo(lett.letter)" size="mini">
                  {{lett.letter}}
                </el-button>
              </el-button-group>
            </div>
          </div>
        </div>
        <div class="row">
          <% /* Главная картинка помёта */ %>
          <div class="col-md-6">
            <div class="left_img">
              <ul v-if="litter.images.length">
                <li v-for="(img ,index, key) in litter.images" :key="index + '-lst'">
                  <a href="#" @click="showSliderImages()">
                    <!--<img class="img-fluid" :src="litter.images[0].imageSrc" alt="">-->
                    <el-image :src="img.imageSrc" v-if="index===litter.cover" :lazy="true">
                      <div slot="placeholder" class="image-slot" style="height:500px;">
                        Loading<span class="dot">...</span>
                      </div>
                    </el-image>
                  </a>
                </li>
              </ul>
            </div>
          </div>

          <div class="offset-md-1 col-md-5">
            <div class="portfolio_right_text ">
              <el-row :gutter="20">
                <% /* Буква помёта */ %>
                <el-col :span="10"><h4><%= __('Litter') %> {{litter.letter.toUpperCase()}}</h4></el-col>
                <% /* Кнопки редактирования помёта (dropdown) */ %>
                <el-col :span="1" :offset="12">
                  <div v-if="me.isAdmin || me.isSuperAdmin" class="grid-content bg-purple">
                    <el-dropdown @command="handleCommand">
                <span class="el-dropdown-link">
                  <el-link :underline="false"> <i class="el-icon-more el-icon--right"></i></el-link>
                </span>
                      <el-dropdown-menu slot="dropdown">
                        <el-dropdown-item icon="el-icon-edit" :command="{com:'e'}">
                          <%= __('Change description') %>
                        </el-dropdown-item>

                        <el-dropdown-item icon="el-icon-star-off" :command="{com:'link'}">
                          <%= __('Change album art') %>
                        </el-dropdown-item>
                      </el-dropdown-menu>
                    </el-dropdown>
                  </div>
                </el-col>
              </el-row>
              <% /* Краткое описание помёта */ %>
              <p v-if="litter.subtitle">{{litter.subtitle}}</p>

              <% /* Звёздочки рейтинга */ %>
              <div class="block mb-5">
                <el-rate
                  v-model="ratio"
                  :colors="colors"
                  @change="changeRatio(litter.letter.toUpperCase())"
                  show-score
                  text-color="#ff9900"
                  score-template=" <%= __('points') %> {value} "
                >
                </el-rate>
              </div>
              <% /* Описание и данные о помёте */ %>
              <ul class="list">
                <li><span><%= __('Dob') %>
                    <el-tooltip v-if="isAfterDate" class="item" effect="dark"
                                content="<%= __("Date of litter. If the date has not yet arrived, then the mating has taken place and the birth is expected on that date.") %>"
                                placement="right-start">
                           <i class="el-icon-question"></i>
                   </el-tooltip>
                  </span>: {{litter.bornNt}}
                </li>
                <li><span><%= __('Name') %>
                    <el-tooltip class="item" effect="dark"
                                content="<%= __("The letter with which the puppy's name should begin.") %>"
                                placement="right-start">
                           <i class="el-icon-question"></i>
                   </el-tooltip>
                  </span>: {{litter.letter.toUpperCase()}}...
                </li>
                <li><span><%= __('Sire') %></span>: <a @click="goTo(`/dogs/${litter.sire[0]}`)"> {{litter.sire[1]}}</a>
                </li>
                <li><span><%= __('Dam') %></span>: <a @click="goTo(`/dogs/${litter.dam[0]}`)"> {{litter.dam[1]}}</a>
                </li>

              </ul>
              <% /* Кнопки PEDIGREE */ %>
              <el-row :gutter="20">
                <el-col :span="2">
                  <% /*@click="goTo('/pedigree')" */ %>
                  <el-button class="mt-4" @click="clickPedigree()" type="primary" round>Pedigree</el-button>
                </el-col>
              </el-row>
            </div>
          </div>
        </div>
        <div class="row ">
          <% /* Полное описание помёта */ %>
          <div class="col ">
            {{litter.description}}
          </div>
        </div>

      </div>

      <% /* Разделитель описания помёта и блока где выводятся фотосессии*/ %>
      <el-divider content-position="left"><%= __('Puppies this litter') %>.
        <span v-if="litter.puppies">{{litter.bornNt}}</span>
        <span v-else><%= __('It has not happened yet. We wait...') %></span>
      </el-divider>

      <div  class="mb-lg-5"  v-if="litter.puppies">
        <% /* ФОТОСЕССИИ */ %>
        <div class="mb-lg-3" v-for="(photoSet, index, key) in litter.puppies" :key="index +  '-photoSet'">
          <el-row :gutter="20">
            <% /* Имя фотосессии */ %>
            <el-col :span="10" :offset="7">
              <h5 class="text-center"> {{photoSet.sessionName}}</h5>
            </el-col>
            <% /* Кнопки управления фотосессией */ %>
            <el-col :span="1" :offset="6">
              <div v-if="me.isAdmin || me.isSuperAdmin" class="grid-content bg-purple">
                <el-dropdown @command="handleCommand">
                <span class="el-dropdown-link">
                  <el-link :underline="false"> <i class="el-icon-more el-icon--right"></i></el-link>
                </span>
                  <el-dropdown-menu slot="dropdown">
                    <el-dropdown-item icon="el-icon-camera-solid" :command="{com:'c'}">
                      <%= __('Add photo session') %>
                    </el-dropdown-item>
                    <el-dropdown-item icon="el-icon-camera" :command="{com:'a',i:index}">
                      <%= __('Change photo session name') %>
                    </el-dropdown-item>
                    <el-dropdown-item icon="el-icon-camera" :command="{com:'b',i:index}">
                      <%= __('Change photo session description') %>
                    </el-dropdown-item>
                    <el-dropdown-item icon="el-icon-delete-solid" :command="{com:'d',i:index}">
                      <%= __('Delete photo session') %>
                    </el-dropdown-item>

                  </el-dropdown-menu>
                </el-dropdown>
              </div>
            </el-col>
          </el-row>

          <% /*  */ %>
          <div class="card-body" >
            <!--<h4 class="card-title"> {{litter.bornNt}}</h4>-->
            <% /*Описание фотосессии.*/ %>
            <div class="card-text"><p>
                {{photoSet.descriptionPhotoSession}}</p></div>
            <div class="card-text mt-sm-4">
              <% /*Маленькие фото. Превью.*/ %>
              <ul class="flex-container wrap" v-if="photoSet.photos">
                <li class="flex-item" v-for="(img, index, key) in photoSet.photos"
                    :key="index +  '-label'">
                  <template v-if="me.isSuperAdmin">
                    <div class="ell-relation" v-if="litter.cover === index">
                      <!--<el-button type="warning" size="mini" title="<%= __("Album's cover") %>"-->
                      <!--class="ell-position-button check" icon="el-icon-star-off"-->
                      <!--circle/>-->
                    </div>
                    <div class="ell-relation" v-else>
                      <!--<el-button size="mini" title="<%= __('Make an album cover') %>"-->
                      <!--class="ell-position-button" @click="coverPhoto(litter.id,index)"-->
                      <!--icon="el-icon-document" circle></el-button>-->
                    </div>

                  </template>
                  <div class="ell-image-flex">
                    <a href="#" @click="showSlider(index)">
                      <img :src="img.imageSrc" class="ell object-fit_cover" alt="">
                    </a>
                  </div>

                </li>
              </ul>
            </div>


          </div>
          <el-divider ><i class="el-icon-star-on"></i></el-divider>
        </div>
      </div>
    </div>
  </section>

  <!-- End Portfolio Details Area -->
  <router-view></router-view>
</div>
<%- /* Expose server-rendered data as window.SAILS_LOCALS :: */ exposeLocalsToBrowser() %>
